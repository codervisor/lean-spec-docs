---
id: 'validation'
title: 'Validation'
sidebar_position: 12
---
# Validation

Ensure spec quality with LeanSpec's built-in validation.

## Overview

The `validate` command checks specs against quality standards defined by the [First Principles](/docs/guide/understanding#the-five-first-principles), particularly **Context Economy** (specs must fit in working memory).

## Validate Command

Check specs for quality issues:

```bash
lspec validate
```

Validates all specs by default. Check specific specs:

```bash
lspec validate <spec-1> <spec-2>
```

## Quality Checks

### Line Count Analysis

Based on **Context Economy** principle:

- **‚úÖ Ideal**: &lt;300 lines - Fits comfortably in working memory
- **‚ö†Ô∏è Warning**: 300-400 lines - Consider simplifying or splitting
- **üî¥ Error**: &gt;400 lines - Must split into sub-specs

**Rationale**: 
- Human attention span: 5-10 minutes
- AI context windows: Limited and expensive
- Physics + Biology + Economics = Hard limit

### Sub-Spec Validation

Checks sub-spec files (DESIGN.md, TESTING.md, IMPLEMENTATION.md, etc.):

- Each sub-spec also follows line limits
- Total spec size (main + sub-specs) tracked
- Recommends splitting if any file exceeds threshold

### Frontmatter Validation

Ensures required fields are present and valid:

**Required Fields:**
- `status`: Must be valid (planned, in-progress, complete, etc.)
- `priority`: Must be valid (high, medium, low, none)
- `created`: Valid date format

**Optional Fields (validated if present):**
- `tags`: Proper format
- `depends_on`, `related`: Valid spec references
- Custom fields: Proper types

### Structure Validation

Checks spec organization:

- README.md exists (main spec file)
- Sub-specs follow naming conventions
- No orphaned or duplicate content

## Validation Output

### Clean Validation

```bash
$ lspec validate

‚úÖ All specs valid!

Summary:
  ‚Ä¢ 45 specs checked
  ‚Ä¢ 0 errors
  ‚Ä¢ 0 warnings
```

### With Warnings

```bash
$ lspec validate

‚ö†Ô∏è  Warnings found:

058-docs-overview-polish/README.md
  ‚ö†Ô∏è  Line count: 385 lines (approaching limit)
  ‚Üí Consider: Simplifying or splitting into sub-specs

Summary:
  ‚Ä¢ 45 specs checked
  ‚Ä¢ 0 errors
  ‚Ä¢ 1 warning
```

### With Errors

```bash
$ lspec validate

‚ùå Errors found:

042-complex-spec/README.md
  üî¥ Line count: 487 lines (exceeds limit)
  ‚Üí Action: Split into sub-specs (see spec 012)

043-broken-spec/README.md
  üî¥ Invalid status: 'in_progress' (should be 'in-progress')
  üî¥ Missing required field: 'created'

Summary:
  ‚Ä¢ 45 specs checked
  ‚Ä¢ 3 errors
  ‚Ä¢ 0 warnings
```

## Custom Validation Options

### Set Custom Thresholds

```bash
# Stricter threshold
lspec validate --max-lines 250

# More lenient threshold
lspec validate --max-lines 500
```

### Validate Specific Aspects

```bash
# Only check line counts
lspec validate --check lines

# Only check frontmatter
lspec validate --check frontmatter

# Only check structure
lspec validate --check structure
```

## Complexity Analysis

Validation detects complexity issues:

### Line Count Distribution

```
Spec Complexity Report:

&lt;200 lines:  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 30 specs (67%)
200-300:     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 10 specs (22%)
300-400:     ‚ñà‚ñà‚ñà 4 specs (9%)
&gt;400 lines:  ‚ñì 1 spec (2%) ‚ö†Ô∏è

Recommendation: Split 042-complex-spec
```

### Sub-Spec Analysis

```
042-complex-spec:
  README.md:           487 lines üî¥
  DESIGN.md:          245 lines ‚úÖ
  IMPLEMENTATION.md:  312 lines ‚ö†Ô∏è
  Total:            1,044 lines

Recommendation:
  ‚Ä¢ Split README.md into multiple sub-specs
  ‚Ä¢ Consider splitting IMPLEMENTATION.md
```

## Fixing Validation Issues

### Line Count Violations

**Problem**: Spec exceeds 400 lines

**Solution**: Split using sub-specs (see [spec 012](https://github.com/codervisor/lean-spec/tree/main/specs/012-sub-spec-files))

```markdown
# Before: Single 500-line spec
README.md (500 lines) üî¥

# After: Split into focused sub-specs
README.md (200 lines) ‚úÖ - Overview, decision, summary
DESIGN.md (150 lines) ‚úÖ - Detailed design
IMPLEMENTATION.md (150 lines) ‚úÖ - Implementation plan
```

### Invalid Frontmatter

**Problem**: Invalid or missing frontmatter fields

**Solution**: Use `lspec update` to fix:

```bash
# Fix status
lspec update <spec> --status in-progress

# Fix priority
lspec update <spec> --priority high

# Fix tags
lspec update <spec> --tags feature,api
```

### Structure Issues

**Problem**: Missing README.md or malformed sub-specs

**Solution**: 
- Ensure README.md exists as main spec file
- Follow sub-spec naming: DESIGN.md, TESTING.md, etc.
- Use proper frontmatter in all files

## Workflows

### Pre-Commit Check

Run before committing:

```bash
lspec validate
```

Fix any errors before committing changes.

### CI/CD Integration

Add to your CI pipeline:

```yaml
# .github/workflows/validate.yml
name: Validate Specs

on: [push, pull_request]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: npm install -g lean-spec
      - run: lspec validate
```

### Regular Review

Weekly spec health check:

```bash
# Check overall health
lspec validate

# Detailed analysis
lspec stats --full

# Review large specs
lspec validate --max-lines 300
```

## Best Practices

1. **Validate early** - Before committing
2. **Fix warnings promptly** - Don't let them accumulate
3. **Split at 400 lines** - Use sub-specs for complex features
4. **Automate** - Add to CI/CD pipeline
5. **Regular reviews** - Weekly health checks

## Understanding Results

### When to Split

Split when:
- ‚úÖ Spec exceeds 400 lines (Context Economy violation)
- ‚úÖ Multiple distinct concerns (different topics)
- ‚úÖ Spec takes &gt;10 minutes to read
- ‚úÖ Frequent editing causes confusion

Don't split when:
- ‚ùå Under 300 lines and focused
- ‚ùå Single cohesive concept
- ‚ùå Quick to read and understand

### When to Simplify

Simplify when:
- Excessive detail for simple feature
- Repeated information
- Low signal-to-noise ratio
- Future speculation

### When to Accept Warnings

Sometimes warnings are acceptable:
- Temporarily high during active development
- Complex feature needing comprehensive detail
- Splitting would reduce clarity

Always re-evaluate later.

## Tips

- Run validation before commits
- Use `--max-lines` for stricter checks during reviews
- Combine with `lspec stats` for overall project health
- Address errors immediately, warnings within sprint
- Automate in CI/CD for team consistency

## Example Validation Report

```bash
$ lspec validate

üîç Validating 45 specs...

‚úÖ Passed (43 specs)
  ‚Ä¢ 040-api-design: 245 lines ‚úÖ
  ‚Ä¢ 041-testing-strategy: 198 lines ‚úÖ
  ‚Ä¢ 043-launch-plan: 287 lines ‚úÖ
  ...

‚ö†Ô∏è  Warnings (1 spec)
  ‚Ä¢ 058-docs-restructure: 385 lines
    ‚Üí Approaching limit, consider simplifying

üî¥ Errors (1 spec)
  ‚Ä¢ 042-complex-feature: 487 lines
    ‚Üí Exceeds limit, must split into sub-specs
    ‚Üí Recommendation: Create DESIGN.md and IMPLEMENTATION.md

Summary:
  ‚Ä¢ Total: 45 specs
  ‚Ä¢ Passed: 43 (96%)
  ‚Ä¢ Warnings: 1 (2%)
  ‚Ä¢ Errors: 1 (2%)

Action Required:
  ‚Üí Fix errors before merging
  ‚Üí Review warnings this sprint
```

## Learning More

- **[Understanding LeanSpec](/docs/guide/understanding)** - First Principles and Context Economy
- **[Sub-Spec Files](https://github.com/codervisor/lean-spec/tree/main/specs/012-sub-spec-files)** - How to split large specs
- **[Board & Stats](/docs/guide/board-stats)** - Project health monitoring
- **[CLI Reference](/docs/reference/cli)** - Complete command documentation
