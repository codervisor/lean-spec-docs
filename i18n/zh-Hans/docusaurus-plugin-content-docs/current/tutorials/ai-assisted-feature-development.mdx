---
title: AI 辅助的功能开发
sidebar_position: 2
description: 将 LeanSpec 与 Copilot Agent Mode 配对，端到端交付真实功能。
---

# AI 辅助的功能开发

**时间**：30-40 分钟  
**目标**：从规格说明 → AI 计划 → 人类验证 → 交付功能，不失去对齐。

## 场景
为任务列表添加 "优先级过滤器"。用户应该能够切换高、中、低或全部。过滤器选择必须在会话之间持久化。

## 前置条件
- 已完成 [使用 AI 编写你的第一个规格说明](./writing-first-spec-with-ai)
- 已通过 \`lean-spec create task-priority-filter\` 创建规格说明
- 具有 MCP 访问仓库的 GitHub Copilot Agent Mode（已共享 \`AGENTS.md\`）

## 第 1 步：让 Agent 了解背景（01:00）
1. 运行 \`lean-spec view task-priority-filter\` 确认规格说明是最新的。
2. 在 agent 聊天中，共享文件路径：

\`\`\`
请阅读 specs/002-task-priority-filter/README.md。用你自己的话确认
目标、成功标准和计划阶段。
\`\`\`

3. 等待总结。如果遗漏了细节（例如，持久化），回复：
   \`明确指出持久化——状态应该存储在哪里？\`

## 第 2 步：请求实施计划（04:00）
提示：

\`\`\`
创建一个逐步的实施计划，引用规格说明的各个部分。
将其分解为我可以按顺序应用的提交。
\`\`\`

预期类似：
- 提交 1：过滤器 UI 脚手架
- 提交 2：状态 + 过滤逻辑
- 提交 3：持久化 + 测试

将计划复制到规格说明的 \`## 计划（Plan）\` 或 \`## 实施说明（Implementation Notes）\` 下，以便进度保持可见。

## 第 3 步：逐阶段执行（08:00）
对于每个阶段，遵循此循环：

1. **提示**

\`\`\`
实施计划中的阶段 1：构建 FilterBar.tsx，包含按钮和活动状态。
仅关注 UI 连接——暂时不要持久化。
\`\`\`

2. **审查差异**。要求 agent 解释任何非平凡的更改。
3. **更新规格说明** 并添加检查框：

\`\`\`markdown
**阶段 1：UI 外壳** ✅
- [x] 过滤器按钮在列表上方渲染
- [x] 活动状态突出显示
- [x] 发出 \`onFilterChange\` 回调
\`\`\`

对后续阶段（逻辑、持久化、测试）重复。将提示范围限定在当前阶段，以保持上下文经济。

## 第 4 步：处理规格说明中的变更（16:00）
如果你发现新需求——比如，显示每个过滤器的任务计数——先更新规格说明：

\`\`\`markdown
## 设计（更新）
- 每个过滤器按钮根据缓存的任务列表显示 \`标签（计数）\`。
\`\`\`

然后告诉 agent：

\`\`\`
规格说明已更新：过滤器按钮必须显示计数。
相应修改 FilterBar 和数据钩子。保持范围在阶段 2 内。
\`\`\`

在 \`## 备注（Notes）\` 或 \`## 演进（Evolution）\` 部分记录更改，以便未来读者知道范围为何转移。

## 第 5 步：使用命令验证（22:00）

\`\`\`bash
npm test
lean-spec validate task-priority-filter
\`\`\`

逐字与 agent 共享失败信息。提示想法：

\`\`\`
测试失败：过滤器状态未持久化。这是错误信息...
使用规格说明的持久化标准进行调试。
\`\`\`

不断迭代，直到两个命令都通过。

## 第 6 步：完成循环（30:00）
1. 更新规格说明：

\`\`\`bash
lean-spec update task-priority-filter --status complete
\`\`\`

2. 添加简短的 \`## 结果（Outcome）\` 部分，总结：
   - 指标（token 计数、测试覆盖率）
   - 与原始计划的变化
   - PR/提交的链接

3. 将最终规格说明链接粘贴回 agent，以便它可以从完成的工作中学习。

## 观察到的好处
- **人类清晰度**：随着需求变化，规格说明保持真实。
- **AI 自主性**：Agent 在具有明确成功标准的范围阶段内运作。
- **可追溯性**：看板/状态更新准确显示功能何时交付。

## 检查清单
- ☐ Agent 在编码之前总结了规格说明
- ☐ 实施计划存在于规格说明内
- ☐ 每个阶段后更新规格说明
- ☐ 测试 + \`lean-spec validate\` 通过
- ☐ 状态标记为 \`complete\` 并附有结果说明

## 下一步教程
1. [使用 AI 管理多个规格说明 →](./managing-multiple-specs-with-ai)
<- [Full 2. [与 AI Agent 的团队协作 →](./team-collaboration-ai-agents) -->

通过 [AI 辅助的规格说明编写](/docs/advanced/ai-assisted-spec-writing) 和 [MCP 集成](/docs/guide/usage/mcp-integration) 深化你的实践。
